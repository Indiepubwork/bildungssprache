<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promptbibliothek | bildungssprache.net</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --success: #22c55e;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* Header */
        header {
            background: var(--card-bg);
            border-bottom: 1px solid var(--border);
            padding: 1.5rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
        }

        .logo:hover {
            color: var(--primary-dark);
        }

        .main-link {
            color: var(--text-light);
            text-decoration: none;
            font-size: 0.875rem;
            transition: color 0.2s;
        }

        .main-link:hover {
            color: var(--primary);
        }

        /* Filter Section */
        .filters {
            padding: 2rem 0;
        }

        .filter-row {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
            padding: 0.75rem 1rem;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            outline: none;
            transition: border-color 0.2s;
        }

        .search-input:focus {
            border-color: var(--primary);
        }

        .category-select {
            padding: 0.75rem 1rem;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: var(--card-bg);
            cursor: pointer;
            outline: none;
            min-width: 200px;
        }

        .category-select:focus {
            border-color: var(--primary);
        }

        .count-display {
            color: var(--text-light);
            font-size: 0.875rem;
            padding: 0.5rem 0;
        }

        /* Cards Grid */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
            padding-bottom: 3rem;
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            border: 1px solid var(--border);
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text);
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.625rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            white-space: nowrap;
        }

        .card-preview {
            font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
            font-size: 0.875rem;
            color: var(--text-light);
            line-height: 1.5;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--card-bg);
            border-radius: 16px;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            animation: modalIn 0.2s ease-out;
        }

        @keyframes modalIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
            line-height: 1;
            padding: 0.25rem;
        }

        .close-btn:hover {
            color: var(--text);
        }

        .modal-body {
            padding: 1.5rem;
            overflow-y: auto;
            flex: 1;
        }

        .modal-badge {
            margin-bottom: 1rem;
        }

        .prompt-text {
            font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
            font-size: 0.9375rem;
            line-height: 1.7;
            background: var(--bg);
            padding: 1.25rem;
            border-radius: 8px;
            white-space: pre-wrap;
            word-break: break-word;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .source-link {
            color: var(--text-light);
            font-size: 0.875rem;
            text-decoration: none;
        }

        .source-link:hover {
            color: var(--primary);
            text-decoration: underline;
        }

        .copy-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-size: 0.9375rem;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .copy-btn:hover {
            background: var(--primary-dark);
        }

        .copy-btn.copied {
            background: var(--success);
        }

        /* Footer */
        footer {
            background: var(--card-bg);
            border-top: 1px solid var(--border);
            padding: 2rem 0;
            text-align: center;
            margin-top: auto;
        }

        footer a {
            color: var(--primary);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        footer p {
            color: var(--text-light);
            font-size: 0.875rem;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-light);
        }

        .empty-state h3 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            color: var(--text);
        }

        /* Category Colors */
        .badge-bildungssprache { background: #dbeafe; color: #1e40af; }
        .badge-briefe { background: #fce7f3; color: #9d174d; }
        .badge-spiele { background: #d1fae5; color: #065f46; }
        .badge-kritisches-denken { background: #fef3c7; color: #92400e; }
        .badge-diskussion { background: #e0e7ff; color: #3730a3; }
        .badge-lernen { background: #cffafe; color: #0e7490; }
        .badge-schule { background: #ede9fe; color: #5b21b6; }
        .badge-geschichte { background: #fee2e2; color: #991b1b; }
        .badge-textanalyse { background: #f3e8ff; color: #7c3aed; }
        .badge-prufungsvorbereitung { background: #ffedd5; color: #c2410c; }
        .badge-sokratische-methode { background: #ecfccb; color: #3f6212; }
        .badge-studium { background: #fef9c3; color: #854d0e; }
        .badge-feynman-methode { background: #f0fdf4; color: #166534; }
        .badge-fragetechniken { background: #fdf4ff; color: #86198f; }
        .badge-textverbesserung { background: #f1f5f9; color: #475569; }
        .badge-prompting { background: #e0f2fe; color: #0369a1; }
        .badge-recherche { background: #fdf2f8; color: #be185d; }

        /* Responsive */
        @media (max-width: 640px) {
            .header-content {
                flex-direction: column;
                align-items: flex-start;
            }

            .filter-row {
                flex-direction: column;
            }

            .search-input,
            .category-select {
                width: 100%;
            }

            .cards-grid {
                grid-template-columns: 1fr;
            }

            .modal-footer {
                flex-direction: column;
            }

            .copy-btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <a href="https://bildungssprache.net" class="logo">Promptbibliothek</a>
            <a href="https://bildungssprache.net" class="main-link">bildungssprache.net</a>
        </div>
    </header>

    <main class="container">
        <section class="filters">
            <div class="filter-row">
                <input type="text" class="search-input" id="searchInput" placeholder="Prompts durchsuchen...">
                <select class="category-select" id="categorySelect">
                    <option value="">Alle Kategorien</option>
                </select>
            </div>
            <div class="count-display" id="countDisplay">0 von 0 Prompts</div>
        </section>

        <section class="cards-grid" id="cardsGrid">
            <!-- Cards werden hier eingefügt -->
        </section>
    </main>

    <footer>
        <div class="container">
            <p>Eine Sammlung von Prompts von <a href="https://bildungssprache.net">bildungssprache.net</a></p>
        </div>
    </footer>

    <!-- Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Prompt-Titel</h2>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-badge" id="modalBadge"></div>
                <div class="prompt-text" id="modalPrompt"></div>
            </div>
            <div class="modal-footer">
                <a href="#" class="source-link" id="sourceLink" target="_blank">Zum Artikel</a>
                <button class="copy-btn" id="copyBtn">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                    </svg>
                    Kopieren
                </button>
            </div>
        </div>
    </div>

    <script>
        // App State
        let allPrompts = [];
        let currentPrompt = null;

        // DOM Elements
        const searchInput = document.getElementById('searchInput');
        const categorySelect = document.getElementById('categorySelect');
        const cardsGrid = document.getElementById('cardsGrid');
        const countDisplay = document.getElementById('countDisplay');
        const modalOverlay = document.getElementById('modalOverlay');
        const modalTitle = document.getElementById('modalTitle');
        const modalBadge = document.getElementById('modalBadge');
        const modalPrompt = document.getElementById('modalPrompt');
        const sourceLink = document.getElementById('sourceLink');
        const copyBtn = document.getElementById('copyBtn');
        const closeModal = document.getElementById('closeModal');

        // Hilfsfunktion: Kategorie zu CSS-Klasse
        function categoryToClass(kategorie) {
            return 'badge-' + kategorie.toLowerCase()
                .replace(/ä/g, 'a')
                .replace(/ö/g, 'o')
                .replace(/ü/g, 'u')
                .replace(/ß/g, 'ss')
                .replace(/\s+/g, '-');
        }

        // Kategorien aus Daten extrahieren und Dropdown füllen
        function populateCategories(prompts) {
            const categories = [...new Set(prompts.map(p => p.kategorie))].sort();
            categories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                categorySelect.appendChild(option);
            });
        }

        // Karte erstellen
        function createCard(prompt) {
            const card = document.createElement('article');
            card.className = 'card';
            card.setAttribute('data-id', prompt.id);

            const preview = prompt.prompt.length > 80
                ? prompt.prompt.substring(0, 80) + '...'
                : prompt.prompt;

            card.innerHTML = `
                <div class="card-header">
                    <h3 class="card-title">${prompt.titel}</h3>
                    <span class="badge ${categoryToClass(prompt.kategorie)}">${prompt.kategorie}</span>
                </div>
                <p class="card-preview">${preview}</p>
            `;

            card.addEventListener('click', () => openModal(prompt));
            return card;
        }

        // Karten rendern
        function renderCards(prompts) {
            cardsGrid.innerHTML = '';

            if (prompts.length === 0) {
                cardsGrid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <h3>Keine Prompts gefunden</h3>
                        <p>Versuche einen anderen Suchbegriff oder eine andere Kategorie.</p>
                    </div>
                `;
                countDisplay.textContent = '0 von ' + allPrompts.length + ' Prompts';
                return;
            }

            prompts.forEach(prompt => {
                cardsGrid.appendChild(createCard(prompt));
            });

            countDisplay.textContent = prompts.length + ' von ' + allPrompts.length + ' Prompts';
        }

        // Filter anwenden
        function filterPrompts() {
            const searchTerm = searchInput.value.toLowerCase().trim();
            const selectedCategory = categorySelect.value;

            const filtered = allPrompts.filter(prompt => {
                const matchesSearch = !searchTerm ||
                    prompt.titel.toLowerCase().includes(searchTerm) ||
                    prompt.prompt.toLowerCase().includes(searchTerm);

                const matchesCategory = !selectedCategory ||
                    prompt.kategorie === selectedCategory;

                return matchesSearch && matchesCategory;
            });

            renderCards(filtered);
        }

        // Modal öffnen
        function openModal(prompt) {
            currentPrompt = prompt;
            modalTitle.textContent = prompt.titel;
            modalBadge.innerHTML = `<span class="badge ${categoryToClass(prompt.kategorie)}">${prompt.kategorie}</span>`;
            modalPrompt.textContent = prompt.prompt;
            sourceLink.href = 'https://bildungssprache.net/?p=' + prompt.artikel_id;
            sourceLink.textContent = prompt.artikel_titel;

            // Reset copy button
            copyBtn.classList.remove('copied');
            copyBtn.innerHTML = `
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
                Kopieren
            `;

            modalOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Modal schließen
        function closeModalFn() {
            modalOverlay.classList.remove('active');
            document.body.style.overflow = '';
            currentPrompt = null;
        }

        // In Zwischenablage kopieren
        async function copyToClipboard() {
            if (!currentPrompt) return;

            try {
                await navigator.clipboard.writeText(currentPrompt.prompt);
                copyBtn.classList.add('copied');
                copyBtn.innerHTML = `
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Kopiert!
                `;

                setTimeout(() => {
                    copyBtn.classList.remove('copied');
                    copyBtn.innerHTML = `
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                        </svg>
                        Kopieren
                    `;
                }, 2000);
            } catch (err) {
                console.error('Kopieren fehlgeschlagen:', err);
            }
        }

        // Event Listeners
        searchInput.addEventListener('input', filterPrompts);
        categorySelect.addEventListener('change', filterPrompts);
        closeModal.addEventListener('click', closeModalFn);
        copyBtn.addEventListener('click', copyToClipboard);

        modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay) {
                closeModalFn();
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && modalOverlay.classList.contains('active')) {
                closeModalFn();
            }
        });

        // App initialisieren
        function initApp(prompts) {
            allPrompts = prompts;
            populateCategories(prompts);
            renderCards(prompts);
        }

        // Daten laden
        fetch('data/prompts.json')
            .then(res => res.json())
            .then(data => initApp(data.prompts))
            .catch(err => {
                console.error('Fehler beim Laden der Prompts:', err);
                cardsGrid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <h3>Fehler beim Laden</h3>
                        <p>Die Prompts konnten nicht geladen werden.</p>
                    </div>
                `;
            });
    </script>

    <!-- Analytics -->
    <script type="text/javascript">
    var SlimStatParams = { ajaxurl: "https://bildungssprache.net/wp-admin/admin-ajax.php" };
    </script>
    <script src="https://cdn.jsdelivr.net/wp/wp-slimstat/trunk/wp-slimstat.min.js"></script>
</body>
</html>
